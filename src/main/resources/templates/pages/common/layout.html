<!doctype html>
<html lang="ja" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" 
  xmlns:sec="http://www.springframework.org/schema/security"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head th:fragment="head">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="">
<!-- Favicon -->
<link rel="icon" type="images/x-icon" th:href="@{/images/favicon.ico}" />

<title>稼働状況管理システム</title>

<!-- CSS Global Compulsory -->
<link rel="stylesheet" th:href="@{/css/app.css}" />
<link rel="stylesheet" th:href="@{/unify/assets/vendor/bootstrap/bootstrap.min.css}" />

<!-- JS Global Compulsory -->
<script th:src="@{/js/app.js}"></script>
<script th:src="@{/unify/assets/vendor/jquery/jquery.min.js}"></script>
<script th:src="@{/unify/assets/vendor/jquery-3.3.1.slim.min.js}"></script>
<script th:src="@{/unify/assets/vendor/popper.min.js}"></script>
<script th:src="@{/unify/assets/vendor/bootstrap/bootstrap.min.js}"></script>
</head>

<body class="d-flex flex-column" style="min-height: 100vh">
  
  <div th:fragment="header(text)">
    <header>
      <h5 th:text="${text}"></h5>
    </header>
  </div>
  
  <main class="mb-auto">
    <div th:fragment="sideMenu">
      <sideMenu id="sideMenu">
        <!--/* Modalダイアログ */-->
        <div th:include="common/components :: modalDialog"></div>
        <div class="wrapper">
          <!-- Sidebar  -->
          <nav id="sidebar">
            <div class="sidebar-header">
              <h3>稼働状況管理<br>システム</h3>
            </div>
            <div th:with=
               "menus = ${ {'TOP', '稼働状況情報', '契約情報', 'スタッフ情報', '案件管理', '取引先管理', 'ユーザ管理'} }, 
                paths = ${ {'__@{/top}__',
                            '__@{/assignments}__',
                            '__@{/contracts}__',
                            '__@{/staffs}__',
                            '__@{/projects}__',
                            '__@{/clients}__',
                            '__@{/maintenance/users/}__'
                         } },
                toPaths = ${ {'__@{/top}__',
                             '__@{/assignments}__',
                             '__@{/contracts}__',
                             '__@{/staffs}__',
                             '__@{/projects}__',
                             '__@{/clients}__',
                             '__@{/maintenance/users/search?roleName=ALL&nonDeleted=on}__'
                         } },
                roles   = ${ {'USER,ADMIN',
                             'USER,ADMIN',
                             'USER,ADMIN',
                             'USER,ADMIN',
                             'USER,ADMIN',
                             'USER,ADMIN',
                             'ADMIN'
                         } },
                uri   = ${#httpServletRequest.requestURI}">
              <ul class="list-unstyled" th:each="menu, status : ${menus}">
                <li th:if="${#strings.contains(roles[__${status.index}__], sessionUserRole)}" 
                  th:with="bg=${#strings.contains(uri, paths[__${status.index}__])} ? 'background-color:#dc9edc;' : '' "
                  th:style="${bg}">
                  <a th:href="${toPaths[__${status.index}__]}">[[${menu}]]</a></li>
              </ul>
            </div>
            <ul class="list-unstyled ctas">
              <li><a class="article" href="javascript:App.logout();">ログアウト</a></li>
            </ul>
          </nav>
        </div>
      </sideMenu>
            
      <!-- contents -->
      <div layout:fragment="contents">
        <contents></contents>
      </div>
    </div>
  </main>
  <!-- Copyright Footer -->
  <div th:fragment="footer">
    <footer id="footer" class="">
      <div class="text-center">
        <small class="g-font-size-default g-mr-10 g-mb-10 g-mb-0--md">&copy; Careritz & Partners. All Rights Reserved</small>
      </div>
    </footer>
  </div>
</body>
</html>
